import{j as e,r as d,a as S,A as _,u as E}from"./index-B-HLU7e3.js";import{L as h,S as C}from"./Status-DXB1ilza.js";import{P as D}from"./position-CtgMU1tI.js";function p({name:s,color:t,onChange:r,isChecked:a=!1,disabled:o=!1}){const n=t==="yellow";return e.jsxs("label",{className:`flex flex-row items-center gap-8 ${n?"text-yellow":"text-light_navy"}`,children:[e.jsx("input",{type:"radio",name:s,value:s,checked:a,disabled:o,className:"hidden",onChange:l=>r(l.target.value)}),e.jsx("span",{className:`w-16 h-16 rounded-50 border-2 transition ${n?`border-yellow ${a?"bg-yellow":""}`:`border-light_navy ${a?"bg-light_navy":""}`}`}),e.jsx("span",{className:"font-roobert_semibold text-20 capitalize",children:s})]})}function T({radioGroupValue:s,radioGroupOnChange:t,disabled:r=!1}){const[a,o]=d.useState(s),n=c=>{o(c),t(c)},l=a==="Yes";return e.jsxs("div",{className:"w-full flex flex-col gap-16",children:[e.jsxs("div",{className:"flex flex-row justify-center gap-64",children:[e.jsx(p,{name:"Yes",color:"yellow",onChange:n,isChecked:l,disabled:r}),e.jsx(p,{name:"No",color:"light_navy",onChange:n,isChecked:a==="No",disabled:r})]}),r&&e.jsx("p",{className:"font-roobert_regular text-16 text-red text-center",children:"Can't update your vote since it's less than 1 day notice."}),a&&e.jsx("div",{className:`w-full font-roobert_semibold text-16 text-center p-8 rounded-8 ${l?"text-dark_navy bg-yellow":"text-sky_blue bg-light_navy"}`,children:l?"Letâ€™s knock it out.":"Recharge and do it next time."})]})}const Y=(s,t)=>{const r=Math.abs(t.getTime()-s.getTime());return Math.ceil(r/(1e3*60*60*24))};function k({_id:s,name:t,date:r,employees:a,activeEmployee:o,allEmployees:n,isManager:l}){const[c,j]=d.useState(new Set(a)),[x,b]=d.useState(c.has(o._id)?"Yes":"No");d.useEffect(()=>{j(i=>{const u=new Set(i);return x==="Yes"?u.add(o._id):u.delete(o._id),u})},[x]);const{triggerRequest:w}=S({query:"put",url:`${_.SATURDAY_API_URI}/${s}`}),f=Array.from(c);d.useEffect(()=>{w({reqBody:{name:t,employees:f}})},[c]);const y=f.map(i=>n[i]),m={Foreman:[],Lead:[],Installer:[],Electrician:[]};y.forEach(i=>{m[i.position].push(i)});const I=new Date,[N,v,$]=r.split("-").map(Number),A=new Date(N,v,$),R=Y(I,A)<2;return e.jsxs("section",{className:"flex flex-col gap-32","aria-label":t,children:[e.jsx("h2",{"aria-label":t,className:"flex justify-center",children:e.jsx(h,{name:t,text:"text-20"})}),!l&&e.jsx(T,{radioGroupValue:x,radioGroupOnChange:b,disabled:R}),y.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(h,{name:"Sunrunners coming in",text:"text-20"}),D.map(i=>{const u=m[i.title];return u.length>0&&e.jsx("ul",{className:"flex flex-row flex-wrap gap-16",children:u.map(g=>e.jsx("li",{className:`font-roobert_regular text-16 text-dark_navy p-8 rounded-8 ${i.color}`,children:g.nickname},`${t}_Saturday_${i.title}_Ul_${g._id}_Li`))},`${t}_Saturday_${i.title}_Ul`)})]})]})}function P({saturdaysHashTable:s,activeEmployee:t,employeesHashTable:r,isManager:a}){return e.jsx("div",{className:"grow flex flex-col gap-32",children:Object.entries(s).map(([o,{name:n,date:l,employees:c}])=>e.jsx(k,{_id:o,name:n,date:l,employees:c,activeEmployee:t,allEmployees:r.allEmployees,isManager:a},`${n}_${o}_Saturday`))})}function O(){const[s,t]=d.useState({}),{status:r,triggerRequest:a}=S({query:"get",url:_.SATURDAY_API_URI,onSuccess:c=>{t(c)}});d.useEffect(()=>{a()},[]);const{employee:o,employeesHashTable:n,isManager:l}=E();return s&&n?e.jsx(P,{saturdaysHashTable:s,activeEmployee:o,employeesHashTable:n,isManager:l}):e.jsx(C,{status:r,errorMessage:"Error fetching Saturdays."})}export{O as default};
